<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>PDFTOXLS</title>
   <link rel="SHORTCUT ICON" href="~/Content/favicon.ico" />
     <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
<link href='https://fonts.googleapis.com/css?family=Roboto:500,900italic,900,400italic,100,700italic,300,700,500italic,100italic,300italic,400' rel='stylesheet' type='text/css'>
    
    <link href="@Url.Content("~/Content/jquery-ui.min.css")" rel="stylesheet" type="text/css" />

     <link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/font-awesome.min.css")" rel="stylesheet" type="text/css" />
 
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
     <link href="@Url.Content("~/Content/chosen.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/alertify.core.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/alertify.bootstrap.css")" rel="stylesheet" type="text/css" />
     <link href="@Url.Content("~/Content/ui.jqgrid.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/layout-jqgrid.css")" rel="stylesheet" type="text/css" />
     
    <!-- Add fancyBox -->
     <script src="@Url.Content("~/Scripts/jquery-1.11.2.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script>
   
      
   <script src="@Url.Content("~/Scripts/bootstrap.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/respond.min.js")" type="text/javascript"></script>
   <script src="@Url.Content("~/Scripts/jquery.form.min.js")" type="text/javascript"></script>

    <script src="@Url.Content("~/Scripts/chosen.jquery.min.js")" type="text/javascript"></script>

   <script src="@Url.Content("~/Scripts/alertify.min.js")" type="text/javascript"></script>

   <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
  <script src="@Url.Content("~/ckeditor/ckeditor.js")" type="text/javascript"></script>
    @*<script src="@Url.Content("~/Scripts/jquery.plugin.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.timeentry.js")" type="text/javascript"></script>*@

      <script src="@Url.Content("~/Scripts/grid.locale-en.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"></script>

    <script src="@Url.Content("~/Scripts/timeformatjs/jquery.timeago.js")" type="text/javascript"></script>
     <script src="@Url.Content("~/Scripts/timeformatjs/jquery.createtime.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/timeformatjs/jquery.fortime.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/timeformatjs/test_helpers.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.mask.min.js")" type="text/javascript"></script>
    
    <script src="@Url.Content("~/Scripts/angular.min.js")"></script>

     <script src="@Url.Content("~/Scripts/console-sham.js")" type="text/javascript"></script>
      <script src="@Url.Content("~/Scripts/angular-file-upload.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/js/PdfToExcel.js")" type="text/javascript"></script>
    <script type="text/javascript">
        var auto_refresh = false;
        function beforeloading() {
            $("#loadingDiv").show();
        }


        function popmodalview(url, el) {

            var url = url;

            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            // alert($(el).attr("title"));

            //alert(rel);


            var agent = "";
            var Team = "";
            var createdDate = "";
            var dueby = "";
            var STATUS = "";

            var FilterId = "";
            var Priority = "";
            var Requester = "";

            var Customer = "";

            if ($("#Agents").val() != null && $("#Agents").val() != "") {
                agent = $("#Agents").val().toString();
            }
            if ($("#Team").val() != null && $("#Team").val() != "") {
                Team = $("#Team").val().toString();
            }
            if ($("#STATUS").val() != null && $("#STATUS").val() != "") {
                STATUS = $("#STATUS").val().toString();
            }
            if ($("#dueby").val() != null && $("#dueby").val() != "") {
                dueby = $("#dueby").val().toString();
            }
            if ($("#createdDate").val() != null && $("#createdDate").val() != "") {
                createdDate = $("#createdDate").val().toString();
            }
            if ($("#Priority").val() != null && $("#Priority").val() != "") {
                Priority = $("#Priority").val().toString();
            }
            if ($("#FilterId").val() != null && $("#FilterId").val() != "") {
                FilterId = $("#FilterId").val().toString();
            }
            if ($("#Requester").val() != null && $("#Requester").val() != "") {
                Requester = $("#Requester").val().toString();
            }

            if ($("#Customer").val() != null && $("#Customer").val() != "") {

                Customer = $("#Customer").val().toString();
            }
            //-------------------------------------------------------------------------


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }

            $.ajax({
                type: "POST",
                url: url,
                data: { AgentsList: agent, Team: Team, createdDate: createdDate, dueby: dueby, STATUS: STATUS, Priority: Priority, Requester: Requester, Customer: Customer },

                cache: false,
                beforeSend: function () {
                    $("#ovrdiv").fadeIn();
                  
                },
                // timeout: 10000, 
                success: function (data) {
                    //alert("abc");
                    $("#myModalTitle").html("Export Preferences");
                    $("#myModalcontent").html(data);
                    $("#popdiv").css("width", "0");
                    $("#popdiv").css("width", lastrel);
                    $("#popdiv").fadeIn();
                }
            })
  .fail(function () {

  })
 .always(function () {
     // alert("always");
 });
        }


        
        function popmodalTeam(url, el) {

            var url = url;
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            url = url + rowval;
         


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(":").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                            
                        },
                        // timeout: 10000, 
                        success: function (data) {

                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }

        }
        function midboardlarge(url,el) {

            var url = url;
         
            var rowval = $("#rowtext").val();
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            url = url + rowval;
            //alert(url);


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(":").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                           
                        },
                        // timeout: 10000, 
                        success: function (data) {

                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();

                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }

        }
        function popmodalSaveSqlFilter(url, el) {

            var url = url;
            var rowval = $("#rowtext").val();

            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            var agent = "";
            var Team = "";
            var createdDate = "";
            var STATUS = "";
            var dueby = "";
            var FilterId = "";
            var Priority = "";
            var Requester = "";
            if ($("#Agents").val() != null && $("#Agents").val() != "") {
                agent = $("#Agents").val().toString();
            }
            if ($("#Team").val() != null && $("#Team").val() != "") {
                Team = $("#Team").val().toString();
            }
            if ($("#STATUS").val() != null && $("#STATUS").val() != "") {
                STATUS = $("#STATUS").val().toString();
            }
            if ($("#dueby").val() != null && $("#dueby").val() != "") {
                dueby = $("#dueby").val().toString();
            }
            if ($("#createdDate").val() != null && $("#createdDate").val() != "") {
                createdDate = $("#createdDate").val().toString();
            }
            if ($("#Priority").val() != null && $("#Priority").val() != "") {
                Priority = $("#Priority").val().toString();
            }
            if ($("#FilterId").val() != null && $("#FilterId").val() != "") {
                FilterId = $("#FilterId").val().toString();
            }
            if ($("#Requester").val() != null && $("#Requester").val() != "") {
                Requester = $("#Requester").val().toString();
            }
            //alert(rowval);
            url = url + rowval;
            //alert(url);
            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }

            $.ajax({
                type: "POST",
                url: url,
                data: { AgentsList: agent, Team: Team, createdDate: createdDate, dueby: dueby, STATUS: STATUS, Priority: Priority, Requester: Requester, FilterId: FilterId },
                cache: false,
                beforeSend: function () {
                    $("#ovrdiv").fadeIn();
                   
                },
                // timeout: 10000, 
                success: function (data) {
                  
                    //alert("abc");
                    $("#myModalTitle").html(title);
                    $("#myModalcontent").html(data);
                    $("#popdiv").css("width", "0");
                    $("#popdiv").css("width", lastrel);
                    $("#popdiv").fadeIn();
                    $("#datepicker").datepicker();
                }
            })
  .fail(function () {

  })
 .always(function () {
     // alert("always");
 });
        }

        function popmodalForChangePickup(url, el) {

            var url = url;
            var wordsstr = url.split('/');
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            // url = url + rowval;
            //alert(url);
            var recordmod = $("#recordmod").val()
            urlfinal = url + rowval + "&recordmod=" + recordmod;



            var words = recordmod.split(',');
            var flag = 0;
            for (i = 0; i < words.length; i++) {
                if (words[i] != 12) {
                    flag = 1;
                    break;
                }
            }
          
            if (flag == 1) {
                alertify.alert("You Can Only Pick The New Records");
                return;
            }


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(",").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: urlfinal,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                          
                        },
                        // timeout: 10000, 
                        success: function (data) {
                         
                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }

        }

        function popmodal(url,el) {

            var url = url;
            var wordsstr = url.split('/');
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            // url = url + rowval;
            //alert(url);
            var recordmod = $("#recordmod").val()
            urlfinal = url + rowval + "&recordmod=" + recordmod;

         

            var words = recordmod.split(',');
            var flag = 0;
            for (i = 0; i < words.length; i++) {
                if (words[i] != 7) {
                    flag = 1;
                    break;
                }
            }
            //alert(wordsstr[2]);
            //if (flag == 1 &&  wordsstr[2]=="ChangePickup") {
            //    alertify.alert("You Can Only Pick The New Records");
            //    return;
            //}


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(",").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: urlfinal,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                           
                        },
                        // timeout: 10000, 
                        success: function (data) {
                           
                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }
        }

        function popmodalcustomerclose(url, el) {

            var url = url;
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            url = url + rowval;
            //alert(url);

            var assignorId = $("#USERID").val();
            var currentUserid = $("#currentUserid").val();
            //alert(assignorId);
            //alert(currentUserid);
            if (assignorId != currentUserid) {
                alertify.alert("You don't have permission to Closed this Ticket");
                return;

            }

            var recordmod = $("#recordmod").val()
            var words = recordmod.split(',');
            var flag = 0;
            for (i = 0; i < words.length; i++) {
                if (words[i] != 3 && words[i] != 10) {
                    flag = 1;
                    break;
                }
            }
            if (flag == 1) {
                alertify.alert("You Can Only Pick The Solved Records");
                return;
            }


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(":").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                          
                        },
                        // timeout: 10000, 
                        success: function (data) {
                        
                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }

        }

        function popmodalForSolution(url, el) {

            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            var url = url;
            $.ajax({
                type: "POST",
                url: url,
                data: "",
                cache: false,
                beforeSend: function () {
                    $("#ovrdiv").fadeIn();
                   
                },
                // timeout: 10000, 
                success: function (data) {
                  
                    //alert("abc");
                    $("#myModalTitle").html(title);
                    $("#myModalcontent").html(data);
                    $("#popdiv").css("width", "0");
                    $("#popdiv").css("width", lastrel);
                    $("#popdiv").fadeIn();
                    $("#datepicker").datepicker();
                }
            })
         .fail(function () {

         })
        .always(function () {
            // alert("always");
        });
        }





        function popmodalclose(url,el) {

            var url = url;
            var wordsstr = url.split('/');
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }

            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            url = url + rowval;
            //alert(url);

            var assignorId = $("#assignorId").val();
            var currentUserid = $("#currentUserid").val();
          
            if (assignorId != currentUserid) {
                alertify.alert("You don't have permission to Resolved this Ticket");
                return;
                
            }

            var recordmod = $("#recordmod").val()
            var words = recordmod.split(',');
            var flag = 0;
            if (wordsstr[1] == "Changes") {

                for (i = 0; i < words.length; i++) {
                    if (words[i] != 24) {
                        flag = 1;
                        break;
                    }
                }
                if (flag == 1) {
                    alertify.alert("You Can Only Pick The Changed Records");
                    return;
                }

            } else {
                for (i = 0; i < words.length; i++) {
                    if (words[i] != 7) {
                        flag = 1;
                        break;
                    }
                }

                if (flag == 1) {
                    alertify.alert("You Can Only Pick The Resolved Records");
                    return;
                }
            }
            


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(":").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                           
                        },
                        // timeout: 10000, 
                        success: function (data) {
                           
                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }
        }

        function popmodalchangestatus(url, el) {
            var url = url;
            var rowval = $("#rowtext").val();
            if(rowval==null || rowval=='')
            {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            } 

            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
           
            //alert(url);
            var recordmod = $("#recordmod").val()
            var assigned_to_id = $("#assigned_to_id").val()

            //alert("helllo"+rowval);
            urlfinal = url + rowval + "&recordmod=" + recordmod + "&assigned_to_id=" + assigned_to_id;

            //var words = recordmod.split(',');
            //var flag = 0;
            //for (i = 0; i < words.length; i++) {
            //    if (words[i] != 7) {
            //        flag = 1;
            //        break;
            //    }
            //}
            //if (flag == 1) {
            //    alertify.alert("You Can Only Pick The Resolved Records");
            //    return;
            //}


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }

            //if ((rowval.split(",").length - 1) > 1) {
            //    alertify.alert('Please select only one row at a time..');

            //} else {

                $.ajax({
                    type: "POST",
                    url: urlfinal,
                    data: "",
                    cache: false,
                    beforeSend: function () {
                        $("#ovrdiv").fadeIn();
                      
                    },
                    // timeout: 10000, 
                    success: function (data) {
                       
                        //alert("abc");
                        $("#myModalTitle").html(title);
                        $("#myModalcontent").html(data);
                        $("#popdiv").css("width", "0");
                        $("#popdiv").css("width", lastrel);
                        $("#popdiv").fadeIn();
                        $("#datepicker").datepicker();
                    }
                })
      .fail(function () {

      })
     .always(function () {
         // alert("always");
     });
            //}


        }

        function popmodalassign(url, el) {


            var url = url;
            var wordsstr = url.split('/');
           
            var rowval = $("#rowtext").val();

            var Lastassigned_to_id = $("#assigned_to_id").val();

            url = url + rowval + "&Lastassigned_to_id=" + Lastassigned_to_id;

           // alert(url);

            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
           // alert(rowval);
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            //url = url + rowval;
            var Primaryconsult = $("#Primaryconsult").val();

            if (Primaryconsult != "Isprimary") {
                alertify.alert("You don't have permission to assign this Ticket");
                return;
            }
            var recordmod = $("#recordmod").val()
            var words = recordmod.split(',');
            var flag = 0;
            if (wordsstr[1] == "Changes") {
                for (i = 0; i < words.length; i++) {
                    if (words[i] != 16) {
                        flag = 1;
                        break;
                    }
                }

            }
            else {

                for (i = 0; i < words.length; i++) {
                    if (words[i] == 5 && words[i] == 6) {
                        //if (words[i] != 7 && words[i] != 1 && words[i] != 4 && words[i] != 13 && words[i] != 12) {
                            flag = 1;
                        break;
                    }
                }
            }
           
            if (flag == 1) {
                alertify.alert("Selected Record does not qualify to Assign");
                return;
            }


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }
            if (rowval != '') {


                if ((rowval.split(":").length - 1) > 1) {
                    alertify.alert('Please select only one row at a time..');

                }
                else {
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: "",
                        cache: false,
                        beforeSend: function () {
                            $("#ovrdiv").fadeIn();
                            
                        },
                        // timeout: 10000, 
                        success: function (data) {
                            
                            //alert("abc");
                            $("#myModalTitle").html(title);
                            $("#myModalcontent").html(data);
                            $("#popdiv").css("width", "0");
                            $("#popdiv").css("width", lastrel);
                            $("#popdiv").fadeIn();
                            $("#datepicker").datepicker();
                        }
                    })
          .fail(function () {

          })
         .always(function () {
             // alert("always");
         });


                }


            } else {
                alertify.alert("Please select at least one row");

            }

        }

        function popmodalnochk(url, el) {

            var url = url;
            var rowval = $("#rowtext").val();
            if (rowval == null || rowval == '') {
                alertify.alert('Nothing to Select');
                return;
            }
            if (rowval.split(",").length > 1) {
                alertify.alert('Please select only one row at a time..');
                return;
            }
            var title = $(el).attr("title");
            var rel = $(el).attr("rel");
            //alert(rowval);
            // url = url + rowval;
            //alert(url);


            $("#myModalcontent,#myModalTitle").empty();

            var lastrel;
            var windowwidth = $(window).width();
            if (windowwidth <= 768) {
                lastrel = "96%";
            } else {


                if (rel == "xsmallboard") {
                    var lastrel = "250"
                } else if (rel == "smallboard") {
                    var lastrel = "420";
                } else if (rel == "midboard") {
                    var lastrel = "600";
                } else if (rel == "midboardlarge") {
                    var lastrel = "60%";
                } else if (rel == "largeboard") {
                    var lastrel = "80%";
                }
            }

            $.ajax({
                type: "POST",
                url: url,
                data: "",
                cache: false,
                beforeSend: function () {
                    $("#ovrdiv").fadeIn();
                  
                },
                // timeout: 10000, 
                success: function (data) {
                   
                    //alert("abc");
                    $("#myModalTitle").html(title);
                    $("#myModalcontent").html(data);
                    $("#popdiv").css("width", "0");
                    $("#popdiv").css("width", lastrel);
                    $("#popdiv").fadeIn();

                    $("#datepicker").datepicker();
                }
            })
  .fail(function () {

  })
 .always(function () {
     // alert("always");
 });
        }


         $(function () {

             $("#datepicker").datepicker();

             $(".closebtn").on("click", function (e) {
               
                 e.preventDefault();
                 $("#myModalcontent,#myModalTitle").empty();
                 $("#ovrdiv").fadeOut();
                 $("#popdiv").fadeOut();

             })

             var windowheight = $(window).height();
             var topbarheight = $(".tophead ").outerHeight(true);
             var addformheight = (windowheight - topbarheight) - 20;
             $('#placeholder').css('min-height', addformheight);
            // $(".chosen-select").chosen();

             $("#menu-holder li a:not('.dropdown-toggle')").on('click', function () {
                 $('.navbar-collapse.in').collapse('hide');
             });
             $("#right-menu-holder li a:not('.dropdown-toggle')").on('click', function () {
                 $('.navbar-collapse.in').collapse('hide');
             });
         });
         function closemodal() {
             
             $("#ovrdiv").fadeOut();
             $("#popdiv").hide('fast');
             $("#myModalcontent,#myModalTitle").empty();
             $("#loadingDiv").hide();

         }
  </script> 
    

  <script type="text/javascript">
   
      function SaveEditAjax(SaveUrl) {

          for (var instanceName in CKEDITOR.instances) {
              CKEDITOR.instances[instanceName].updateElement();
          }
          jQuery(function () {

              var form = jQuery('form');
              form.validate();
              if (form.valid()) {

                  //jQuery('form').bind('click', function (event) {
                  //event.preventDefault();                   // using this page stop being refreshing 
                  jQuery.ajax({
                      type: 'POST',
                      url: SaveUrl,
                      cache: false,
                      beforeSend: function () {
                          // before send the request, displays a "Loading..." messaj in the element where the server response will be placed
                          var odiv = '<div class="overlaydiv"><div class="preloader"><img src="$siteRoot/Content/images/ajax-loader-pop.gif" alt="PDFTOXLSCRM" /> </div></div>'
                          jQuery(odiv).appendTo('body');
                      },
                      //timeout: 10000,
                      data: jQuery('form').serialize(),
                      success: function (data, textStatus, jqXHR) {
                         
                          if (data.trim() == "Category") {
                           
                              $("#myModalcontent,#myModalTitle").empty();
                             
                             // GetBodyList('prev');
                            //  GetFilterBody('New & My open Tickets', 19);
                          }
                         

                      }
                  }).fail(function () {
                      //jQuery('.overlaydiv').remove();
                      //show_stack_bottomright('error', "Fail to load this page");
                  });
                  return false;
              };

          });
      }


        var lasturlassign = "";
        $(document).ready(function () {
            $.ajaxSetup({ cache: false });
      
            checkURL();
        });

        function ClickHeaderLinkMenu(url) {
            // alert(url);
            EntryFormloadPage(url);
        }
        function checkURL(hash) {
            if (lasturlassign == "") {
                hash = window.location.hash;

            }
       
            var newurl = "";
            //if no parameter is provided, use the hash value from the current address 
            if (hash.indexOf("#") >= 0) {
                hash = hash.replace('#', '');
                var urlarr = hash.split("-");
                if (urlarr.length == 2) {

                    var controller = urlarr[0];
                    var viewname = urlarr[1];
                    newurl = "/" + controller.trim() + "/" + viewname.trim() + "#" + controller + "-" + viewname;
                } else {
                    var controller = urlarr[0];
                    var viewname = urlarr[1];
                    var idname = urlarr[2];
                    var idvalue = urlarr[3];
                    newurl = "/" + controller.trim() + "/" + viewname.trim() + "#" + idname + "-" + idvalue;
                }
          
                if (newurl != lasturlassign) // if the hash value has changed
                {
                    lasturlassign = newurl; //update the current hash
                    EntryFormloadPage(newurl); // and load the new page

                }
            }

        }

        function EntryFormloadPage(url) //the function that loads pages via AJAX
        {
           
            $.ajax({
                type: "POST",
                url: url,
                data: "",
                beforeSend: function () {
                    beforeloading();
                    
                },
                //cache: false,
            success: function (msg) {

                if (msg == "SessionOut") {
                    window.location = "/Home/Index";
                } else {
                    //$('.overlaydiv').remove();
                    //$('#systemWorking').empty();
                 
                    $('#placeholder').html("");
                   
                    $('#placeholder').append(msg).fadeIn('normal');
                    $("#loadingDiv").hide();
                    $("#datepicker").datepicker();
                }
            }
        })
      .fail(function () {
          window.location = "/Home/Index";
      })
     .always(function () {
         // alert("always");
     });

    }

    function OnlyLoadPage(url) //the function that loads pages via AJAX
        {
      
        $.ajax({
            type: "POST",
            url: url,
            data: "",
            //cache: false,
            beforeSend:function()
            {
                beforeloading();
            },
            success: function (msg) {
               
                $('#placeholder').html("");

                $('#placeholder').append(msg).fadeIn('normal');
                $("#loadingDiv").hide();

                    var words = url.split('/');
                   
                    if (words[1] == "Ticket" && words[2]=="List") {
                        GetFilterBody('New & My open Tickets', 19);
                    } else if (words[1] == "Changes" && words[2] == "List")
                    {
                        GetFilterBody('New & My open Tickets', 19);
                    }
                    else if (words[1] == "Release" && words[2] == "List") {
                        GetFilterBody('New & My open Tickets', 19);
                    }
                    else if (words[1] == "News" && words[2] == "List") {
                        GetFilterBody('New & My open Tickets', 19);
                    }
                    $("#datepicker").datepicker();

            }
        })
        .fail(function () {
            alert("Fail to Load this page");
            window.location = "/Home/Index";
        })
       .always(function () {

       });

    }


    function OpenNewTabOnlyLoadPage(url) //the function that loads pages via AJAX
    {
        window.open(url);
    }


    function OnlyLoadPageCallFromDashboard(url,xval1,xval2) //the function that loads pages via AJAX
    {

        $.ajax({
            type: "POST",
            url: url,
            data: "",
            //cache: false,
            beforeSend: function () {
                beforeloading();
            },
            success: function (msg) {
                $('#placeholder').html("");
                $('#placeholder').append(msg).fadeIn('normal');
                $("#loadingDiv").hide();
                GetFilterBody(xval1, xval2);
                $("#datepicker").datepicker();

            }
        })
        .fail(function () {
            alert("Fail to Load this page");
            window.location = "/Home/Index";
        })
       .always(function () {

       });

    }

    function OnlyLoadPageCallFromDashboardClosed(url) {


        $.ajax({
            type: "POST",
            url: url,
            data: "",
            //cache: false,
            beforeSend: function () {
                beforeloading();
            },
            success: function (msg) {
                $('#placeholder').html("");
                $('#placeholder').append(msg).fadeIn('normal');
                $("#loadingDiv").hide();
                GetFilterBody('New & My open Tickets', 21);
                $("#datepicker").datepicker();

            }
        })
        .fail(function () {
            alert("Fail to Load this page");
            window.location = "/Home/Index";
        })
       .always(function () {

       });

    }

   
    function menuclose() {

        $(".topmenu button.navbar-toggle").click();
    }

    
    $(document).ready(function () {

        $(document).click(function (event) {

            var clickover = $(event.target);
            var _opened = $("#bs-example-navbar-collapse-1").hasClass("collapse in");

            if (_opened === true && !clickover.hasClass("navbar-toggle")) {
                menuclose();
            }
        });

      

        $('#menu-holder li').click(function () {
            $('#menu-holder li').each(function () {
                $(this).removeClass('active');
            });
            $('#right-menu-holder li').each(function () {
                $(this).removeClass('active');
            });
            $(this).addClass('active');
        });
        $('#right-menu-holder li').click(function () {
            $('#menu-holder li').each(function () {
                $(this).removeClass('active');
            });
            $('#right-menu-holder li').each(function () {
                $(this).removeClass('active');
            });
            $(this).addClass('active');
        });
        $(document).bind("contextmenu", function (e) {
            e.preventDefault();
        });
    });

    $(document).ajaxComplete(function () {
       
        $(document).bind("contextmenu", function (e) {
            e.preventDefault();
        });
        var windowheight = $(window).height();
        var topbarheight = $(".tophead ").outerHeight(true);
        var addformheight = (windowheight - topbarheight) - 20;
        $('#placeholder').css('min-height', addformheight);
    });

   

//////////F12 disable code////////////////////////
  document.onkeypress = function (event) {
      event = (event || window.event);
      if (event.keyCode == 123) {
          //alert('No F-12');
          return false;
      }
  }
    document.onmousedown = function (event) {
        event = (event || window.event);
        if (event.keyCode == 123) {
            //alert('No F-keys');
            return false;
        }
    }
    document.onkeydown = function (event) {
        event = (event || window.event);
        if (event.keyCode == 123) {
            //alert('No F-keys');
            return false;
        }
    }
    /////////////////////end///////////////////////


</script>
   
</head>
<body>
    <div class="wrapper clearfix">
        <header class="tophead container-fluid" id="PDFTOXLSDeskHeaderPartitionId">
<div class="row whiteback">
    <div class="col-xs-4 col-sm-6 col-md-6">
        <img src="~/images/PDFTOXLS-ticket-logo.png" alt="PDFTOXLS Software" class="img-responsive paddingtop7" />
</div>
<div class="col-xs-8 col-sm-6 col-md-6">
    <div class="pull-right">
<ul class="nav navbar-nav navbar-right toprightmenu">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="hidden-xs">Welcome,</span> &nbsp; @ViewBag.UserName &nbsp; &nbsp;&nbsp;<img class="img-circle vertmiddle" src="~/Content/ProfilePics/@ViewBag.userimage" alt="Ticket" width="36" height="36" /></a>
         @*   @ViewBag.UserImagePath*@
          <ul class="dropdown-menu" role="menu">
             <li><a onclick="javascript:OnlyLoadPage('@Url.Action("ProfileEdit", "User")');" href="#Profile-User">My Profile</a></li>
              <li><a onclick="javascript:OnlyLoadPage('@Url.Action("ChangePassword", "User")');" href="#ChangePassword-User">Change Password</a></li>
            <li><a  href="@Url.Action("LogOut", "Home")">Sign Out</a></li>
          </ul>
        </li>
      </ul>
        </div>
    </div>
            
  <div class="col-xs-12">
<div class="row topmenu">
                <nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        @*<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>*@
          <span class="menuiconround">Menu</span>
      </button>
      @*<a class="navbar-brand hidden-sm hidden-md hidden-lg"  data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" href="#">Menu</a>*@
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->



    


    <div class="collapse navbar-collapse nopadding nomarginmob no-transition" id="bs-example-navbar-collapse-1">



<div class="menu-box pointer clearfix hidden-lg hidden-md  hiddensm-mob" onclick="javascript:menuclose();">
    <span class="menuiconroundblack pull-right">MENU</span>

      
</div>







      <ul class="nav navbar-nav mobilemenu" id="menu-holder">

           <li class="active"><a href="@Url.Action("Dashboard", "Dashboard")" class="mobilemeu-border" ><i class="fa fa-tachometer"></i>&nbsp;Pdf To Excel List</a></li>
          
        @*<li class="@ViewBag.DashboardCssClass"><a href="@Url.Action("Dashboard", "Dashboard")"><i class="fa fa-tachometer"></i>&nbsp;Dashboard</a></li>
          <li class="@ViewBag.TicketCssClass"><a href="@Url.Action("List", "Ticket")"><i class="fa fa-ticket"></i>&nbsp;Issues</a></li>  
          <li class="@ViewBag.ChangesCssClass"><a href="@Url.Action("List", "Changes")"><i class="fa fa-pencil"></i>&nbsp;Changes</a></li>      
      
       <li class="@ViewBag.SetupCssClass"><a href="@Url.Action("Define", "Setup")"><i class="fa fa-cog"></i>&nbsp;Setup</a></li> *@
      </ul>

   
       @*<form class="navbar-form navbar-left" role="search">
       <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
      </form>*@
     <ul class="nav navbar-nav navbar-right mobilemenu" id="right-menu-holder">
           
        @*<li><a href="#AddTicket-Ticket" onclick="javascript:OnlyLoadPage('@Url.Action("AddTicket", "Ticket")');" ><i class="fa fa-plus-circle"></i>&nbsp;Add Issue</a>*@
           @* class="dropdown"*@
@*<ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("AddTicket", "Ticket")"><i class="fa fa-ticket"></i>&nbsp;New Ticket</a></li>
            <li><a href="@Url.Action("DefineUser", "User")"><i class="fa fa-user"></i>&nbsp;New User</a></li>
            <li><a href="@Url.Action("DefineGroup", "Group")"><i class="fa fa-users"></i>&nbsp;New User Group</a></li>
 
          </ul>*@
        </li>
        
      </ul>
    </div><!-- /.navbar-collapse -->

    
     
  </div><!-- /.container-fluid -->
</nav>
</div>
            </div>

</div>
        </header>
    <div class="container-fluid nopadding">
<div class="paddingboth clearfix">
<div class="col-xs-12 nopadding">
<div class="addform clearfix" id="placeholder">
   @RenderBody()
</div>
</div>

</div>
    </div>
    </div>

<!-- Modal -->
<div class="overlaydiv" id="ovrdiv" style="display:none;"></div>
<div class="popupdiv clearfix" id="popdiv" style="display:none;">
<div class="pophead clearfix">
<div class="displayleft marginleft8">
<div class="font-head" id="myModalTitle"></div>
</div>
<div class="displayright closebtn" style="display:none;">
<span class="glyphicon glyphicon-remove font-head pointer marginright4"></span>
</div>
</div>

<div class="popcontent"  id="myModalcontent">


</div>

</div>
<div class="suboverlaydiv" id="loadingDiv" style="display:none;">
    <div class="subimagediv"><img src="~/Content/images/ajax-loader-pop.gif" alt="Loading..." /></div>
</div>
</body>
</html>
